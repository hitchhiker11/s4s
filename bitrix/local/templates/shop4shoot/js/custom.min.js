class K1Form{form = null;sendURL = null;successMessage = "Спасибо,ваща заявка отправлена";constructor(){this.form = document.querySelector(".k1-form form");this.sendURL = "/ajax/k1Form.php";this.sendFormBind = this.sendForm.bind(this);if (this.form){new PhoneMask({});this.addHandlers()}}sendForm(event){event.preventDefault();this.form.pageURL.value = location.origin+location.pathname;fetch(this.sendURL,{method:"POST",body:new FormData(this.form)}).then(res => res.json()).then(data =>{if (data.error){for(let code of data.codes){switch (code){case 101:this.form.email.classList.add("k1-error");this.form.email.addEventListener("input",function(event){event.target.classList.remove("k1-error")},{once:true});break;case 102:this.form.phone.classList.add("k1-error");this.form.phone.addEventListener("input",function(event){event.target.classList.remove("k1-error")},{once:true});break;case 103:this.form.name.classList.add("k1-error");this.form.name.addEventListener("input",function(event){event.target.classList.remove("k1-error")},{once:true});break}}}else{this.form.after(this.successMessage);this.form.closest(".k1-form").classList.add("k1-success-send-form");this.form.remove()}})}addHandlers(){this.form.addEventListener("submit",this.sendFormBind)}}// window.addEventListener("load",() =>{// new K1Form();//})