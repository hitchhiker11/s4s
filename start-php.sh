#!/bin/bash

echo "üêò –ó–∞–ø—É—Å–∫ PHP —Å–µ—Ä–≤–µ—Ä–∞..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ PHP
if ! command -v php &> /dev/null; then
    echo "‚ùå PHP –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    echo "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PHP: sudo apt install php"
    exit 1
fi

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
if [ -d "widget" ]; then
    SERVER_DIR="widget"
    echo "üìÅ –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: widget/"
elif [ -d "backend" ]; then
    SERVER_DIR="backend"
    echo "üìÅ –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: backend/"
else
    SERVER_DIR="."
    echo "üìÅ –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –∏–∑ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏"
fi

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Ä—Ç
PORT=${1:-8000}

echo "üåê –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞: http://localhost:$PORT"
echo "üìç –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–µ—Ä–≤–µ—Ä–∞: $SERVER_DIR"
echo "‚èπÔ∏è  –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C"
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º PHP —Å–µ—Ä–≤–µ—Ä
cd "$SERVER_DIR"
php -S localhost:$PORT 