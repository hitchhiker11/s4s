# üè∑Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–µ–Ω–¥–∞–º–∏

## –û–ø–∏—Å–∞–Ω–∏–µ

REST API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–µ–Ω–¥–∞–º–∏ –≤ 1–° –ë–∏—Ç—Ä–∏–∫—Å. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –±—Ä–µ–Ω–¥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å–≤–æ–π—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –±—Ä–µ–Ω–¥–∞–º–∏.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –£ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ `BREND`, –Ω–æ –Ω–µ—Ç —Å–≤—è–∑–∏ —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –±—Ä–µ–Ω–¥–æ–≤ —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `BRAND_ELEMENT`.

**–†–µ—à–µ–Ω–∏–µ:** API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±—Ä–µ–Ω–¥–æ–≤ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
2. –°–æ–∑–¥–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –±—Ä–µ–Ω–¥–æ–≤
3. –°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –±—Ä–µ–Ω–¥–∞–º–∏
4. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

## üìã Endpoints

### `POST /api/brand-manager`
**–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–µ–Ω–¥–∞–º–∏**

### `GET /api/brand-manager/status`  
**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –±—Ä–µ–Ω–¥–æ–≤**

### `GET /api/brand-manager/report`
**–û—Ç—á–µ—Ç –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏**

### `DELETE /api/brand-manager/cleanup`
**–û—á–∏—Å—Ç–∫–∞ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö –±—Ä–µ–Ω–¥–æ–≤**

---

## üîß POST /api/brand-manager

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `action` | string | `sync` | –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏: `sync`, `create`, `update`, `check` |
| `catalog_iblock_id` | integer | `21` | ID –∏–Ω—Ñ–æ–±–ª–æ–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤ |
| `brands_iblock_id` | integer | `22` | ID –∏–Ω—Ñ–æ–±–ª–æ–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –±—Ä–µ–Ω–¥–æ–≤ |

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤–æ–π—Å—Ç–≤
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `brand_property` | string | `BREND` | –ö–æ–¥ —Å–≤–æ–π—Å—Ç–≤–∞ –±—Ä–µ–Ω–¥–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ |
| `brand_element_property` | string | `BRAND_ELEMENT` | –ö–æ–¥ —Å–≤–æ–π—Å—Ç–≤–∞ —Å–≤—è–∑–∏ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º –±—Ä–µ–Ω–¥–∞ |

#### –û–ø—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `force_update` | string | `N` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±—Ä–µ–Ω–¥–æ–≤ |
| `dry_run` | string | `N` | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| `link_products` | string | `Y` | –°–≤—è–∑—ã–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã —Å –±—Ä–µ–Ω–¥–∞–º–∏ |
| `with_logging` | string | `Y` | –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `batch_size` | integer | `100` | –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (10-1000) |

### –¢–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π (action)

#### `sync` - –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –°–æ–∑–¥–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –±—Ä–µ–Ω–¥—ã
- –°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å –±—Ä–µ–Ω–¥–∞–º–∏  
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

#### `create` - –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤
- –°–æ–∑–¥–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –±—Ä–µ–Ω–¥–æ–≤ –±–µ–∑ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
- –ë—ã—Å—Ç—Ä–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

#### `update` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
- –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±—Ä–µ–Ω–¥–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ `force_update=Y`

#### `check` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- –ù–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```bash
curl -X POST "https://yoursite.com/api/brand-manager" \
  -H "Content-Type: application/json" \
  -d '{"action": "sync"}'
```

#### –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
curl -X POST "https://yoursite.com/api/brand-manager" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "sync",
    "dry_run": "Y",
    "with_logging": "Y"
  }'
```

#### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
curl -X POST "https://yoursite.com/api/brand-manager" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "sync",
    "force_update": "Y",
    "batch_size": 50
  }'
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
```bash
curl -X POST "https://yoursite.com/api/brand-manager" \
  -H "Content-Type: application/json" \
  -d '{"action": "check"}'
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞

#### –£—Å–ø–µ—à–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```json
{
  "status": "success",
  "action": "sync",
  "meta": {
    "execution_time": 2.847,
    "timestamp": "2024-01-15 14:30:25",
    "dry_run": false,
    "catalog_iblock_id": 21,
    "brands_iblock_id": 22
  },
  "results": {
    "brands": {
      "total_processed": 25,
      "created": 15,
      "updated": 3,
      "skipped": 7,
      "errors_count": 0,
      "details": {
        "created": [
          {"id": 1001, "name": "Apple", "code": "apple", "action": "created"},
          {"id": 1002, "name": "Samsung", "code": "samsung", "action": "created"}
        ],
        "updated": [
          {"id": 1003, "name": "Sony", "code": "sony", "action": "updated"}
        ],
        "skipped": ["Nokia", "LG", "Xiaomi"],
        "errors": []
      }
    },
    "products": {
      "total_processed": 1250,
      "linked": 1180,
      "already_linked": 45,
      "errors": 25,
      "unlinked": 0
    }
  },
  "recommendations": [
    "25 —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å —Å –±—Ä–µ–Ω–¥–∞–º–∏",
    "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö"
  ]
}
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
```json
{
  "status": "success", 
  "action": "check",
  "meta": {
    "catalog_iblock_id": 21,
    "brands_iblock_id": 22
  },
  "statistics": {
    "catalog_products": 1250,
    "unique_brands_in_catalog": 25,
    "brands_in_directory": 23,
    "linked_products": 1180,
    "unlinked_products": 70,
    "orphaned_brands": 2,
    "consistency_score": 94.4
  },
  "recommendations": [
    "–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ",
    "–ù–∞–π–¥–µ–Ω–æ 2 –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –±—Ä–µ–Ω–¥–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—á–∏—Å—Ç–∫–∞"
  ]
}
```

---

## üìä GET /api/brand-manager/status

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –±—Ä–µ–Ω–¥–æ–≤ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
–¢–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ –∏ –≤ POST-–º–µ—Ç–æ–¥–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X GET "https://yoursite.com/api/brand-manager/status"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞
```json
{
  "status": "success",
  "system_info": {
    "catalog_iblock_id": 21,
    "brands_iblock_id": 22,
    "brand_property": "BREND",
    "brand_element_property": "BRAND_ELEMENT"
  },
  "statistics": {
    "catalog_products": 1250,
    "brands_in_directory": 23,
    "linked_products": 1180,
    "consistency_score": 94.4
  },
  "health_check": {
    "catalog_iblock_exists": true,
    "brands_iblock_exists": true,
    "brand_property_exists": true,
    "brand_element_property_exists": true
  }
}
```

---

## üìÑ GET /api/brand-manager/report

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X GET "https://yoursite.com/api/brand-manager/report"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞
```json
{
  "message": "Report functionality not implemented yet",
  "suggestion": "Check logs at /local/logs/brand_manager.log"
}
```

---

## üóëÔ∏è DELETE /api/brand-manager/cleanup

### –û–ø–∏—Å–∞–Ω–∏–µ
–£–¥–∞–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –Ω–∏ —Å –æ–¥–Ω–∏–º —Ç–æ–≤–∞—Ä–æ–º.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `brands_iblock_id` | integer | `22` | ID –∏–Ω—Ñ–æ–±–ª–æ–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –±—Ä–µ–Ω–¥–æ–≤ |
| `catalog_iblock_id` | integer | `21` | ID –∏–Ω—Ñ–æ–±–ª–æ–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ |
| `brand_element_property` | string | `BRAND_ELEMENT` | –ö–æ–¥ —Å–≤–æ–π—Å—Ç–≤–∞ —Å–≤—è–∑–∏ |
| `dry_run` | string | `N` | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º |

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X DELETE "https://yoursite.com/api/brand-manager/cleanup" \
  -H "Content-Type: application/json" \
  -d '{"dry_run": "Y"}'
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞
```json
{
  "status": "success",
  "action": "cleanup", 
  "results": {
    "orphaned_found": 5,
    "deleted": 3,
    "errors": 2
  },
  "details": {
    "deleted_brands": [
      {"ID": "1010", "NAME": "Discontinued Brand 1"},
      {"ID": "1011", "NAME": "Discontinued Brand 2"}
    ],
    "errors": [
      {
        "brand_id": "1012",
        "brand_name": "Protected Brand",
        "error": "Cannot delete protected element"
      }
    ]
  }
}
```

---

## üîÑ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
curl -X GET "/api/brand-manager/status"

# 2. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫
curl -X POST "/api/brand-manager" -d '{"action": "sync", "dry_run": "Y"}'

# 3. –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
curl -X POST "/api/brand-manager" -d '{"action": "sync"}'
```

### –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
curl -X POST "/api/brand-manager" -d '{"action": "check"}'

# 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
curl -X POST "/api/brand-manager" -d '{"action": "update"}'

# 3. –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –±—Ä–µ–Ω–¥–æ–≤
curl -X DELETE "/api/brand-manager/cleanup"
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
```bash
# 1. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
curl -X POST "/api/brand-manager" -d '{
  "action": "sync",
  "force_update": "Y",
  "batch_size": 50
}'

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
curl -X POST "/api/brand-manager" -d '{"action": "check"}'
```

## üìã –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤
- **–û–ø–µ—Ä–∞—Ü–∏–∏:** `/local/logs/brand_manager.log`
- **–û—à–∏–±–∫–∏:** `/local/logs/brand_manager_errors.log`

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
```json
{
  "timestamp": "2024-01-15 14:30:25",
  "type": "brand_created", 
  "action": "sync",
  "dry_run": false,
  "data": {
    "id": 1001,
    "name": "Apple",
    "code": "apple",
    "action": "created"
  }
}
```

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞ –æ—à–∏–±–∫–∏
```json
{
  "timestamp": "2024-01-15 14:30:30",
  "error": "Failed to create brand: Duplicate entry",
  "file": "/path/to/brandmanager.php",
  "line": 245,
  "context": {
    "brand": "Samsung"
  },
  "action": "sync"
}
```

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π batch_size:** 1000
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π batch_size:** 100
- **Timeout:** 300 —Å–µ–∫—É–Ω–¥
- **Memory limit:** 512MB

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dry_run=Y` –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ø–µ—Ä–µ–¥ –º–∞—Å—Å–æ–≤—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
*/0 4 * * * curl -s -X POST "yoursite.com/api/brand-manager" -d '{"action":"check"}' >> /var/log/brand_check.log

# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
0 2 * * 0 curl -s -X DELETE "yoursite.com/api/brand-manager/cleanup" >> /var/log/brand_cleanup.log
```

## üö® –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –†–µ—à–µ–Ω–∏–µ |
|-----|----------|---------|
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |
| 403 | Native routes –æ—Ç–∫–ª—é—á–µ–Ω—ã | –í–∫–ª—é—á–∏—Ç–µ `useNativeRoute` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ |
| 404 | –ò–Ω—Ñ–æ–±–ª–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ–±–ª–æ–∫–æ–≤ |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ |

## üõ†Ô∏è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Brand property not found"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞
SELECT * FROM b_iblock_property 
WHERE IBLOCK_ID = 21 AND CODE = 'BREND';
```

### –ü—Ä–æ–±–ª–µ–º–∞: "No brands found in catalog"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞
SELECT pev.VALUE, COUNT(*) as cnt 
FROM b_iblock_property_enum pev
JOIN b_iblock_property p ON p.ID = pev.PROPERTY_ID
WHERE p.IBLOCK_ID = 21 AND p.CODE = 'BREND'
GROUP BY pev.VALUE;
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–∏–∑–∫–∏–π consistency_score
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `action=check` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `action=sync` —Å `force_update=Y`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### PHP
```php
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://yoursite.com/api/brand-manager");
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'action' => 'sync',
    'dry_run' => 'N'
]));
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Content-Type: application/json'
]);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$response = curl_exec($ch);
$result = json_decode($response, true);
curl_close($ch);

if ($result['status'] === 'success') {
    echo "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!\n";
    echo "–°–æ–∑–¥–∞–Ω–æ –±—Ä–µ–Ω–¥–æ–≤: " . $result['results']['brands']['created'] . "\n";
    echo "–°–≤—è–∑–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: " . $result['results']['products']['linked'] . "\n";
}
?>
```

### JavaScript
```javascript
async function syncBrands() {
  try {
    const response = await fetch('/api/brand-manager', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        action: 'sync',
        batch_size: 100
      })
    });
    
    const result = await response.json();
    
    if (result.status === 'success') {
      console.log('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞:', result);
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
  }
}
```

---

**üéâ API –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** 

–ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å `dry_run=Y`, –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é. 